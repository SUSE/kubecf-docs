<!doctype html>
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="generator" content="Hugo 0.57.2" />

<META NAME="ROBOTS" CONTENT="INDEX, FOLLOW">



<link rel="shortcut icon" href="/favicons/favicon.ico" >
<link rel="apple-touch-icon" href="/favicons/apple-touch-icon-180x180.png" sizes="180x180">
<link rel="icon" type="image/png" href="/favicons/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="/favicons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/favicons/android-36x36.png" sizes="36x36">
<link rel="icon" type="image/png" href="/favicons/android-48x48.png" sizes="48x48">
<link rel="icon" type="image/png" href="/favicons/android-72x72.png" sizes="72x72">
<link rel="icon" type="image/png" href="/favicons/android-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/favicons/android-144x144.png" sizes="144x144">
<link rel="icon" type="image/png" href="/favicons/android-192x192.png" sizes="192x192">

<title>Secret rotation KubeCF | KubeCF</title><meta property="og:title" content="Secret rotation KubeCF" />
<meta property="og:description" content="How to handle Secrets in KubeCF
" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://kubecf.io/docs/tasks/secrets/" />
<meta property="article:published_time" content="2020-03-19T00:00:00+00:00" />
<meta property="article:modified_time" content="2020-03-20T08:24:13+01:00" /><meta property="og:site_name" content="KubeCF" />
<meta itemprop="name" content="Secret rotation KubeCF">
<meta itemprop="description" content="How to handle Secrets in KubeCF
">


<meta itemprop="datePublished" content="2020-03-19T00:00:00&#43;00:00" />
<meta itemprop="dateModified" content="2020-03-20T08:24:13&#43;01:00" />
<meta itemprop="wordCount" content="646">



<meta itemprop="keywords" content="" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Secret rotation KubeCF"/>
<meta name="twitter:description" content="How to handle Secrets in KubeCF
"/>







<link rel="preload" href="/scss/main.min.de2e3299cd7d4088947e25e9ed887d91ebd756863ab68fb4e3bfec6a311f6c3d.css" as="style">
<link href="/scss/main.min.de2e3299cd7d4088947e25e9ed887d91ebd756863ab68fb4e3bfec6a311f6c3d.css" rel="stylesheet" integrity="">


<link href="/css/offline-search.css" rel="stylesheet">

<script
  src="https://code.jquery.com/jquery-3.3.1.min.js"
  integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
  crossorigin="anonymous"></script>

<script src="https://unpkg.com/lunr@2.1.6/lunr.js"></script>
<script src="/js/offline-search.js"></script>


    <title>Secret rotation KubeCF | KubeCF</title>
  </head>
  <body class="td-page">
    <header>
      
<nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar">
        <a class="navbar-brand" href="/">
		<span class="navbar-logo"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 1071.73 221.27"><defs><linearGradient id="a" x1="-424.28" y1="-348.73" x2="-423.28" y2="-348.73" gradientTransform="matrix(297.1, 0, 0, -297.1, 126823.42, -103498.81)" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#00b1e1"/><stop offset="1" stop-color="#2c75ba"/></linearGradient></defs><title>Asset 4</title><path d="M128.57 217.38 62.99 130.7 46.1 150.82v66.56H0V.83H46.1V97.58L122.72.83H179.54L93.5 102.45 185.38 217.38H128.57z"/><path d="M290.79 217.38v-19.8c-10.71 12-29.54 23.69-55.19 23.69-34.42.0-50.65-18.82-50.65-49.34V60.57h41.24v95.12c0 21.76 11.36 28.9 28.89 28.9 15.91.0 28.57-8.77 35.71-17.86V60.57H332V217.38z"/><path d="M358 217.38V.83h41.24V80.7c12.33-15.91 29.86-24 48.37-24 39.93.0 69.48 31.17 69.48 82.47.0 52.27-29.87 82.13-69.48 82.13-18.83.0-36-8.44-48.37-24v20.13zm76.62-32.79c24 0 39.94-18.18 39.94-45.45s-15.91-45.78-39.94-45.78c-13.31.0-28.57 7.79-35.38 18.18v55.52C406 177.12 421.3 184.59 434.61 184.59z"/><path d="M525.51 138.81c0-45.45 33.44-82.14 81.17-82.14 46.75.0 78.56 35.07 78.56 86.36v9.09H568.69c2.6 19.81 18.51 36.36 45.13 36.36 13.31.0 31.82-5.84 41.88-15.58l18.18 26.62c-15.58 14.29-40.25 21.75-64.61 21.75C561.55 221.27 525.51 189.13 525.51 138.81zm81.17-49.35C581 89.46 570 108.62 568 124.2h77.27C644.34 109.27 634 89.46 606.68 89.46z"/><path d="M964.59 87.19V74.01 41.42H1071.73V.83H918.49V217.38H964.59V175.15 127.78 87.19z"/><path d="M1041.05 90l-23.77-18.87V90h-139a45.54 45.54.0 0 1-31.52-12.64c-.48-.45-1-.91-1.42-1.39a45.78 45.78.0 1 0 0 66.27c.46-.47.94-.93 1.42-1.39a45.59 45.59.0 0 1 31.52-12.64h139v18.87l23.77-18.87 24.07-19.1z" fill="url(#a)"/><path d="M868.23 146A65.12 65.12.0 1 1 868 72.22L907.56 51.6a110.68 110.68.0 0 0-19.67-23.52c-.61.42-1.23.82-1.88 1.18A23.68 23.68.0 0 1 850.85 6.08a110 110 0 0 0-16.21-4.34A112 112 0 0 0 820.33.0c-.17.6-.36 1.19-.58 1.78a23.69 23.69.0 0 1-30.52 13.81 23.6 23.6.0 0 1-11.62-9.44 110.35 110.35.0 0 0-27.46 14.39 25.32 25.32.0 0 1 1.18 2.77 23.68 23.68.0 0 1-31.21 29.81 109.19 109.19.0 0 0-12 28.55 23.7 23.7.0 0 1 12.95 34.57 23.6 23.6.0 0 1-15.21 11 109.48 109.48.0 0 0 9.38 29.88 23.69 23.69.0 0 1 28.5 36.76 108.8 108.8.0 0 0 27 16.67 23.68 23.68.0 0 1 45.87 9 109.18 109.18.0 0 0 31.26-5.21 23.68 23.68.0 0 1 40.22-23.2 109.46 109.46.0 0 0 20-24c-.48-.35-.93-.76-1.39-1.15z"/></svg></span><span class="text-uppercase font-weight-bold">KubeCF</span>
	</a>
	<div class="td-navbar-nav-scroll ml-md-auto" id="main_navbar">
		<ul class="navbar-nav mt-2 mt-lg-0">
			
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				<a class="nav-link active" href="/docs/" ><span class="active">Documentation</span></a>
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				<a class="nav-link" href="/community/" ><span>Community</span></a>
			</li>
			
			
			
		</ul>
	</div>
	<div class="navbar-nav d-none d-lg-block">
<div id="search-nav-container">
<input type="search" id="search-input" autocomplete="off" class="form-control td-search-input" placeholder="&#xf002 Search this site…" autocomplete="on">
<div id="search-results" class="container"></div>
</div>
</div>
</nav>

    </header>
    <div class="container-fluid td-outer">
      <div class="td-main">
        <div class="row flex-xl-nowrap">
          <div class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none">
            




<div id="td-sidebar-menu" class="td-sidebar__inner">
  
  <form class="td-sidebar__search d-flex align-items-center">
    
<div id="search-nav-container">
<input type="search" id="search-input" autocomplete="off" class="form-control td-search-input" placeholder="&#xf002 Search this site…" autocomplete="on">
<div id="search-results" class="container"></div>
</div>

    <button class="btn btn-link td-sidebar__toggle d-md-none p-0 ml-3 fas fa-bars" type="button" data-toggle="collapse" data-target="#td-section-nav" aria-controls="td-docs-nav" aria-expanded="false" aria-label="Toggle section navigation">
    </button>
  </form>
  
  <nav class="collapse td-sidebar-nav pt-2 pl-4" id="td-section-nav">
    
    






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/docs/" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section">Documentation</a>
  </li>
  <ul>
    <li class="collapse show" id="docs">
      
      
      
      
      






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/docs/overview/" class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Overview</a>
  </li>
  <ul>
    <li class="collapse " id="docs-overview">
      
      
      
    </li>
  </ul>
</ul>

      
      
      
      






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/docs/deployment/" class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Deploying KubeCF</a>
  </li>
  <ul>
    <li class="collapse " id="docs-deployment">
      
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-docs-deployment-kubernetes-deploy" href="/docs/deployment/kubernetes-deploy/">Deployment Walkthrough</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-docs-deployment-affinities-and-tolerations" href="/docs/deployment/affinities-and-tolerations/">Affinities and Tolerations</a>
      
      
    </li>
  </ul>
</ul>

      
      
      
      






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/docs/concepts/" class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Concepts</a>
  </li>
  <ul>
    <li class="collapse " id="docs-concepts">
      
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-docs-concepts-operator" href="/docs/concepts/operator/">Operator</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-docs-concepts-quarks" href="/docs/concepts/quarks/">Quarks</a>
      
      
    </li>
  </ul>
</ul>

      
      
      
      






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/docs/tasks/" class="align-left pl-0 pr-2 active td-sidebar-link td-sidebar-link__section">Core Tasks</a>
  </li>
  <ul>
    <li class="collapse show" id="docs-tasks">
      
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-docs-tasks-upgrade" href="/docs/tasks/upgrade/">KubeCF Upgrades</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-docs-tasks-deploy" href="/docs/tasks/deploy/">KubeCF Deployment guidelines</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page  active" id="m-docs-tasks-secrets" href="/docs/tasks/secrets/">KubeCF and Secrets</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-docs-tasks-bosh" href="/docs/tasks/bosh/">Test BOSH Releases</a>
      
      
    </li>
  </ul>
</ul>

      
      
      
      






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/docs/tutorials/" class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Tutorials</a>
  </li>
  <ul>
    <li class="collapse " id="docs-tutorials">
      
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-docs-tutorials-deploy-k3s" href="/docs/tutorials/deploy-k3s/">Deploy KubeCF on K3s</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-docs-tutorials-deploy-kind" href="/docs/tutorials/deploy-kind/">Deploy KubeCF on Kind</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-docs-tutorials-eirini-persi" href="/docs/tutorials/eirini_persi/">Eirini Persistence broker</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-docs-tutorials-deploy-stratos" href="/docs/tutorials/deploy-stratos/">Deploy Stratos next to KubeCF</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-docs-tutorials-bosh-integration" href="/docs/tutorials/bosh-integration/">Bosh releases integration</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-docs-tutorials-deploy-minikube" href="/docs/tutorials/deploy-minikube/">Deploy KubeCF in Minikube</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-docs-tutorials-run-smoke-tests" href="/docs/tutorials/run-smoke-tests/">Run smoke tests</a>
      
      
    </li>
  </ul>
</ul>

      
      
      
      






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/docs/reference/" class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Reference</a>
  </li>
  <ul>
    <li class="collapse " id="docs-reference">
      
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-docs-reference-tests" href="/docs/reference/tests/">Tests</a>
      
      
    </li>
  </ul>
</ul>

      
      
      
      






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/docs/contribution-guidelines/" class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Contribution Guidelines</a>
  </li>
  <ul>
    <li class="collapse " id="docs-contribution-guidelines">
      
      
      
    </li>
  </ul>
</ul>

      
      
    </li>
  </ul>
</ul>

  </nav>
</div>




          </div>
          <div class="d-none d-xl-block col-xl-2 td-toc d-print-none">
            




<div class="td-page-meta ml-2 pb-1 pt-2 mb-0">





<a href="https://github.com/cloudfoundry-incubator/kubecf-docs/edit/master/content/en/docs/Tasks/secrets.md" target="_blank"><i class="fa fa-edit fa-fw"></i> Edit this page</a>
<a href="https://github.com/cloudfoundry-incubator/kubecf-docs/issues/new?title=Secret%20rotation%20KubeCF" target="_blank"><i class="fab fa-github fa-fw"></i> Create documentation issue</a>


<a href="https://github.com/cloudfoundry-incubator/kubecf/issues/new" target="_blank"><i class="fas fa-tasks fa-fw"></i> Create project issue</a>

</div>






<nav id="TableOfContents">
<ul>
<li>
<ul>
<li>
<ul>
<li><a href="#background">Background</a></li>
<li><a href="#finding-secrets">Finding secrets</a></li>
<li><a href="#requesting-a-rotation-for-a-specific-secret">Requesting a rotation for a specific secret</a></li>
</ul></li>
<li><a href="#rotating-the-ccdb-encryption-keys">Rotating the CCDB encryption keys</a></li>
</ul></li>
</ul>
</nav>



          </div>
          <main class="col-12 col-md-9 col-xl-8 pl-md-5" role="main">
            <nav aria-label="breadcrumb" class="d-none d-md-block d-print-none">
	<ol class="breadcrumb spb-1">
		










<li class="breadcrumb-item" >
	<a href="https://kubecf.io/docs/">Documentation</a>
</li>




<li class="breadcrumb-item" >
	<a href="https://kubecf.io/docs/tasks/">Core Tasks</a>
</li>




<li class="breadcrumb-item active" aria-current="page">
	<a href="https://kubecf.io/docs/tasks/secrets/">KubeCF and Secrets</a>
</li>

	</ol>
</nav	>

            
<div class="td-content">
	<h1>Secret rotation KubeCF</h1>
	<div class="lead">How to handle Secrets in KubeCF</div>
	

<p><strong>Rotating secrets</strong> is in general the process of updating one or more
secrets to new values and restarting all affected pods so that they
will use these new values.</p>

<p>Most of the process is automatic. How to trigger it is explained
in the following document.</p>

<p>Beyond this, the keys used to encrypt the Cloud Controller Database
(CCDB) can also be rotated, however, they do not exist as general
secrets of the KubeCF deployment. This means that the general process
explained above <strong>does not apply</strong> to them.</p>

<p>The audience of this document are:</p>

<ul>
<li><p>Developers working on KubeCF.</p></li>

<li><p>Operators deploying KubeCF.</p></li>
</ul>

<h3 id="background">Background</h3>

<p>One of the features KubeCF (or rather the cf-operator it sits on top
of) provides is the ability to declare secrets (passwords and
certificates) and have the system automatically generate something
suitably random for such on deployment, and distribute the results to
the pods using them.</p>

<p>This removes the burden from human operators to come up with lots of
such just to have all the internal components of KubeCF properly wired
up for secure communication.</p>

<p>However, even with this, operators may wish to change such secrets
from time to time, or on a schedule. In other words, re-randomize the
board, and limit the lifetime of any particular secret.</p>

<p>As a note on terminology, this kind of change is called
<strong>rotating a secret</strong>.</p>

<p>This document describes how this can be done, in the context of KubeCF.</p>

<h3 id="finding-secrets">Finding secrets</h3>

<p>Retrieve the list of all secrets maintained by a KubeCF deployment via</p>

<pre><code>kubectl get quarkssecret --namespace kubecf
</code></pre>

<p>To see the information about a specific secret, for example the NATS password, use</p>

<pre><code>kubectl get quarkssecret --namespace kubecf kubecf.var-nats-password --output yaml
</code></pre>

<p>Note that each quarkssecret has a corresponding regulare k8s secret it
controls.</p>

<pre><code>kubectl get secret --namespace kubecf
kubectl get secret --namespace kubecf kubecf.var-nats-password --output yaml
</code></pre>

<h3 id="requesting-a-rotation-for-a-specific-secret">Requesting a rotation for a specific secret</h3>

<p>We keep using <code>kubecf.var-nats-password</code> as our example secret.</p>

<p>To rotate this secret:</p>

<ol>
<li><p>Create a YAML file for a ConfigMap of the form:</p>

<pre><code> ---
 apiVersion: v1
 kind: ConfigMap
 metadata:
   name: rotate-kubecf.var-nats-password
   labels:
     quarks.cloudfoundry.org/secret-rotation: &quot;true&quot;
 data:
   secrets: '[&quot;kubecf.var-nats-password&quot;]'
</code></pre>

<p>Note, while the name of this ConfigMap can be technically
 anything (allowed by k8s syntax) we recommend using a name
 derived from the name of the secret itself, to make the
 connection clear.</p>

<p>Note further that while this example rotates only a single
 secret, the <code>data.secrets</code> key accepts an array of secret names,
 allowing the simultaneous rotation of many secrets together.</p></li>

<li><p>Apply this ConfigMap using:</p>

<pre><code> kubectl apply --namespace kubecf -f /path/to/your/yaml/file
</code></pre></li>

<li><p>The cf-operator will process this ConfigMap due the label</p>

<pre><code> quarks.cloudfoundry.org/secret-rotation: &quot;true&quot;
</code></pre>

<p>and knows that it has to invoke a rotation of the referenced
 secrets.</p>

<p>The actions of the cf-operator can be followed in its log.</p>

<ol>
<li><p>After the cf-operator has done the rotation, i.e. has not only
changed the secrets, but also restarted all affected pods (the
users of the rotated secrets), delete the trigger config map
again:</p>

<p>kubectl delete &ndash;namespace kubecf -f /path/to/your/yaml/file</p></li>
</ol></li>
</ol>

<h2 id="rotating-the-ccdb-encryption-keys">Rotating the CCDB encryption keys</h2>

<p><strong>IMPORTANT</strong> - Always backup the database before rotating the encryption key.</p>

<p>The key used to encrypt the database is generated the first time kubecf is deployed.
It is based on the Helm values:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">ccdb<span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">  </span>encryption<span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span>rotation<span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">      </span>key_labels<span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">      </span>-<span style="color:#f8f8f8;text-decoration:underline"> </span>encryption_key_0<span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">      </span>current_key_label<span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>encryption_key_0</code></pre></div>
<p>For each label under <code>key_labels</code>, kubecf will generate an encryption key.
The <code>current_key_label</code> indicates which key is currently being used.</p>

<p>In order to rotate the CCDB encryption key, add a new label to <code>key_labels</code> (keeping the old
labels), and mark the <code>current_key_label</code> with the newly added label. Example:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">ccdb<span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">  </span>encryption<span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span>rotation<span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">      </span>key_labels<span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">      </span>-<span style="color:#f8f8f8;text-decoration:underline"> </span>encryption_key_0<span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">      </span>-<span style="color:#f8f8f8;text-decoration:underline"> </span>encryption_key_1<span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">      </span>current_key_label<span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>encryption_key_1</code></pre></div>
<p><strong>IMPORTANT</strong> - key labels should be less than 240 characters long.</p>

<p>Then, update the kubecf Helm installation. After Helm finishes its updates, trigger the
<code>rotate-cc-database-key</code> errand:</p>

<p><strong>Note</strong> - the following command assumes the Helm installation is named <code>kubecf</code> and it was
installed to the <code>kubecf</code> namespace. These values may be different depending on how kubecf was
installed.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">kubectl patch qjob kubecf-rotate-cc-database-key <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>  --namespace kubecf <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>  --type merge <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>  --patch <span style="color:#4e9a06">&#39;{&#34;spec&#34;:{&#34;trigger&#34;:{&#34;strategy&#34;:&#34;now&#34;}}}&#39;</span></code></pre></div>
	
	
	<div class="text-muted mt-5 pt-3 border-top">Last modified March 20, 2020: <a  href="https://github.com/cloudfoundry-incubator/kubecf-docs/commit/04a5401836399fc052e3491514e70d9cccda35d3">Drop cross-link section in secret rotation docs (04a5401)</a>
</div>
</div>


          </main>
        </div>
      </div>
      
<footer class="bg-dark py-5 row d-print-none">
  <div class="container-fluid mx-sm-5">
    <div class="row">
      <div class="col-6 col-sm-4 text-xs-center order-sm-2">
        
        
        
      </div>
      <div class="col-6 col-sm-4 text-right text-xs-center order-sm-3">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="GitHub" aria-label="GitHub">
    <a class="text-white" target="_blank" href="https://github.com/cloudfoundry-incubator/kubecf">
      <i class="fab fa-github"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Slack" aria-label="Slack">
    <a class="text-white" target="_blank" href="https://cloudfoundry.slack.com/archives/CQ2U3L6DC">
      <i class="fab fa-slack"></i>
    </a>
  </li>
  
</ul>

        
        
      </div>
      <div class="col-12 col-sm-4 text-center py-2 order-sm-2">
        <small class="text-white">&copy; 2020 CloudFoundry.org Foundation, Inc. All Rights Reserved</small>
        <small class="ml-1"><a href="https://www.cloudfoundry.org/privacy-policy/" target="_blank">Privacy Policy</a></small>
	
		
	
      </div>
    </div>
  </div>
</footer>


    </div>
    
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>






<script src="/js/main.min.b5d3de058a649fced1f6e7f92a12099f8f3338f27890ac1a0d1dae6a1da22af6.js" integrity="sha256-tdPeBYpkn87R9uf5KhIJn48zOPJ4kKwaDR2uah2iKvY=" crossorigin="anonymous"></script>



  </body>
</html>